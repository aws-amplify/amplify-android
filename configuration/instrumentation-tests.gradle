
/*
Need to create backends for s3, pinpoint, predictions, core
 */
def module_backends = [
    'aws-datastore':'InstrumentedTests',
    'aws-api': 'ApiInstrumentedTests'
]



task pullBackendConfigFromAmplify(description: "Pulls backend configurations from Amplify project.") {
    doLast {
        for(entry in module_backends) {
            def moduleName = entry.key
            def amplifyBackendProjectName = entry.value

            println("Getting config files for $amplifyBackendProjectName")
            def amplifyPullCommand =  "$rootDir.path/scripts/pull_backend_config_from_amplify.sh"
            exec {
                workingDir(rootDir.path)
                executable(amplifyPullCommand)
                args([amplifyBackendProjectName, moduleName])
                standardOutput(System.out)
            }
        }
    }
}